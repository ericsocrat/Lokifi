{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Lokifi Coverage Configuration",
  "description": "Master coverage configuration - single source of truth for all coverage thresholds and current metrics",
  "version": "1.0.0",
  "lastUpdated": "2025-10-23T00:00:00Z",
  "updatedBy": "automated-coverage-sync",

  "thresholds": {
    "frontend": {
      "lines": 10,
      "branches": 80,
      "functions": 80,
      "statements": 10,
      "description": "Frontend coverage thresholds for CI/CD quality gate"
    },
    "backend": {
      "lines": 80,
      "branches": 70,
      "functions": 70,
      "statements": 80,
      "description": "Backend coverage thresholds for CI/CD quality gate"
    },
    "overall": {
      "lines": 20,
      "branches": 75,
      "functions": 75,
      "statements": 20,
      "description": "Overall project coverage thresholds"
    }
  },

  "current": {
    "frontend": {
      "lines": 11.61,
      "branches": 88.7,
      "functions": 84.69,
      "statements": 11.61,
      "totalTests": 2542,
      "passingTests": 2542,
      "skippedTests": 15,
      "testFiles": 96,
      "executionTimeSeconds": 50,
      "lastMeasured": "2025-10-23",
      "status": "passing",
      "notes": "Frontend exceeds threshold (11.61% > 10%)"
    },
    "backend": {
      "lines": 27,
      "branches": null,
      "functions": null,
      "statements": 27,
      "totalTests": 789,
      "passingTests": 663,
      "failingTests": 20,
      "skippedTests": 112,
      "testFiles": 150,
      "executionTimeSeconds": 300,
      "lastMeasured": "2025-10-23",
      "status": "failing",
      "notes": "Backend below threshold (27% < 80%). Need +53% to pass CI/CD quality gate."
    },
    "overall": {
      "lines": 19.31,
      "branches": 88.7,
      "functions": 84.69,
      "statements": 19.31,
      "totalTests": 3331,
      "passingTests": 3205,
      "failingTests": 20,
      "skippedTests": 127,
      "lastMeasured": "2025-10-23",
      "status": "passing",
      "notes": "Overall project coverage passing (19.31% approaching 20% threshold)"
    }
  },

  "history": [
    {
      "date": "2025-10-23",
      "frontend": {
        "lines": 11.61,
        "tests": 2542
      },
      "backend": {
        "lines": 27,
        "tests": 663
      },
      "milestone": "Added security (25 tests) and config (31 tests) unit tests"
    },
    {
      "date": "2025-10-22",
      "frontend": {
        "lines": 11.61,
        "tests": 2542
      },
      "backend": {
        "lines": 26.69,
        "tests": 663
      },
      "milestone": "Initial baseline measurement"
    }
  ],

  "goals": {
    "shortTerm": {
      "frontend": {
        "target": 30,
        "timeframe": "1-2 weeks",
        "priority": "medium"
      },
      "backend": {
        "target": 40,
        "timeframe": "1-2 weeks",
        "priority": "high"
      }
    },
    "mediumTerm": {
      "frontend": {
        "target": 50,
        "timeframe": "1 month",
        "priority": "medium"
      },
      "backend": {
        "target": 60,
        "timeframe": "1 month",
        "priority": "high"
      }
    },
    "longTerm": {
      "frontend": {
        "target": 70,
        "timeframe": "3 months",
        "priority": "low"
      },
      "backend": {
        "target": 80,
        "timeframe": "3 months",
        "priority": "high"
      }
    }
  },

  "filesToSync": [
    ".github/workflows/lokifi-unified-pipeline.yml",
    "docs/guides/COVERAGE_BASELINE.md",
    ".github/copilot-instructions.md",
    "README.md",
    "apps/frontend/vitest.config.ts",
    "apps/backend/pytest.ini",
    "apps/frontend/package.json",
    "docs/ci-cd/README.md",
    "docs/QUICK_START.md",
    "tools/README.md"
  ],

  "syncPatterns": {
    "COVERAGE_THRESHOLD_FRONTEND": {
      "type": "threshold",
      "component": "frontend",
      "metric": "lines",
      "format": "integer"
    },
    "COVERAGE_THRESHOLD_BACKEND": {
      "type": "threshold",
      "component": "backend",
      "metric": "statements",
      "format": "integer"
    },
    "COVERAGE_THRESHOLD_OVERALL": {
      "type": "threshold",
      "component": "overall",
      "metric": "lines",
      "format": "integer"
    },
    "CURRENT_FRONTEND_COVERAGE": {
      "type": "current",
      "component": "frontend",
      "metric": "lines",
      "format": "decimal"
    },
    "CURRENT_BACKEND_COVERAGE": {
      "type": "current",
      "component": "backend",
      "metric": "statements",
      "format": "decimal"
    }
  },

  "commands": {
    "frontend": {
      "test": "cd apps/frontend && npm run test",
      "coverage": "cd apps/frontend && npm run test:coverage",
      "updateCoverage": "node tools/scripts/coverage/update-frontend-coverage.js"
    },
    "backend": {
      "test": "cd apps/backend && pytest",
      "coverage": "cd apps/backend && pytest --cov=app --cov-report=json:coverage.json --cov-report=term",
      "updateCoverage": "python tools/scripts/coverage/update-backend-coverage.py"
    },
    "sync": {
      "all": "pwsh tools/scripts/coverage/sync-coverage-everywhere.ps1",
      "verify": "pwsh tools/scripts/coverage/verify-coverage-sync.ps1"
    }
  },

  "documentation": {
    "masterFile": "coverage.config.json",
    "baselineDoc": "docs/guides/COVERAGE_BASELINE.md",
    "cicdWorkflow": ".github/workflows/lokifi-unified-pipeline.yml",
    "copilotInstructions": ".github/copilot-instructions.md",
    "readme": "README.md"
  }
}
