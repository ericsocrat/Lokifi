# Production Deployment Checklist

## ✅ Completed Steps

- [x] **Strong passwords generated** - All secrets created with cryptographically secure random values
- [x] **`.env` file created** - Production environment variables configured
- [x] **Validation passed** - All Docker compose files validated successfully

## 📋 Required Actions (Before Deployment)

### 1. Update API Keys in `.env` (if needed)
```bash
cd C:\Users\USER\Desktop\lokifi\infra\docker
notepad .env
```

Update these values if you need API integrations:
- `ALPHA_VANTAGE_API_KEY` - For stock market data
- `FINNHUB_API_KEY` - For financial data
- `POLYGON_API_KEY` - For market data
- `NEWSAPI_KEY` - For news feeds
- `CMC_KEY` - For cryptocurrency data
- `COINGECKO_API_KEY` - For crypto market data
- `FMP_KEY` - For Financial Modeling Prep

### 2. Update Domain Names

**Option A: Use the automated script**
```powershell
cd C:\Users\USER\Desktop\lokifi\infra\docker
.\setup-production-domains.ps1 -Domain "yourdomain.com" -AdminEmail "admin@yourdomain.com"
```

**Option B: Manual update**
Edit these files and replace placeholders:
- `docker-compose.prod-minimal.yml`:
  - Replace `your-domain.com` with your actual domain
  - Replace `api.your-domain.com` with your API subdomain

- `docker-compose.production.yml`:
  - Replace `lokifi.example.com` with your frontend domain
  - Replace `api.lokifi.example.com` with your API domain
  - Replace `traefik.lokifi.example.com` with your Traefik dashboard domain
  - Replace `admin@lokifi.example.com` with your admin email

### 3. Configure DNS Records

Point these DNS records to your server IP:

| Record Type | Name | Value | TTL |
|-------------|------|-------|-----|
| A | @ | YOUR_SERVER_IP | 3600 |
| A | api | YOUR_SERVER_IP | 3600 |
| A | traefik | YOUR_SERVER_IP | 3600 |

Wait for DNS propagation (can take up to 48 hours, usually 5-10 minutes).

### 4. Server Prerequisites

Ensure your server has:
- [ ] Docker installed (v20.10+ recommended, tested with v28.5.1 / Desktop v4.48.0)
- [ ] Docker Compose installed (v2.0+ recommended, tested with v2.40.0)
- [ ] Minimum 4.5 CPU cores
- [ ] Minimum 4.5GB RAM (8GB recommended)
- [ ] Ports 80, 443 open (for HTTP/HTTPS)
- [ ] Firewall configured to allow necessary traffic

### 5. Security Checklist

- [ ] `.env` file has strong passwords (already done ✅)
- [ ] `.env` file is in `.gitignore`
- [ ] Server firewall is enabled
- [ ] SSH key-based authentication enabled (disable password auth)
- [ ] Fail2ban or similar intrusion prevention installed
- [ ] Regular backup schedule configured
- [ ] SSL/TLS certificates will be auto-generated by Traefik

## 🚀 Deployment Commands

### Minimal Production (Cloud DB)
```bash
cd C:\Users\USER\Desktop\lokifi\infra\docker
docker compose -f docker-compose.prod-minimal.yml up -d
```

### Full Production Stack (Self-hosted)
```bash
cd C:\Users\USER\Desktop\lokifi\infra\docker
docker compose -f docker-compose.production.yml up -d
```

### Check Status
```bash
docker compose -f docker-compose.production.yml ps
docker compose -f docker-compose.production.yml logs -f
```

### Stop Services
```bash
docker compose -f docker-compose.production.yml down
```

## 🔍 Post-Deployment Verification

After deployment, verify:

- [ ] Frontend accessible at `https://yourdomain.com`
- [ ] Backend API at `https://api.yourdomain.com/docs`
- [ ] Health endpoint: `https://api.yourdomain.com/api/health`
- [ ] SSL certificate automatically provisioned (check for HTTPS lock)
- [ ] All containers running: `docker ps`
- [ ] No errors in logs: `docker compose logs`

## 📊 Monitoring

Access monitoring tools (production.yml only):
- **Grafana**: `https://yourdomain.com:3001` (or configure Traefik route)
- **Prometheus**: `http://yourdomain.com:9090`
- **Traefik Dashboard**: `https://traefik.yourdomain.com`

## 🔄 Maintenance Tasks

### Update Containers
```bash
docker compose -f docker-compose.production.yml pull
docker compose -f docker-compose.production.yml up -d
```

### View Logs
```bash
docker compose -f docker-compose.production.yml logs -f [service_name]
```

### Backup Database
```bash
docker exec lokifi-postgres pg_dump -U postgres lokifi > backup_$(date +%Y%m%d).sql
```

### Restart Service
```bash
docker compose -f docker-compose.production.yml restart [service_name]
```

## ⚠️ Important Notes

1. **Passwords**: The generated passwords in `.env` are cryptographically secure. Keep them safe!
2. **Git**: Never commit `.env` to version control
3. **Secrets Rotation**: Change passwords periodically (every 90 days recommended)
4. **Backups**: Set up automated database backups
5. **Monitoring**: Regularly check logs and metrics
6. **Updates**: Keep Docker images updated for security patches

## 📞 Support

If you encounter issues:
1. Check logs: `docker compose logs -f`
2. Verify DNS: `nslookup yourdomain.com`
3. Check container health: `docker ps`
4. Validate compose files: `docker compose config`

---

**Status**: Ready for production deployment! 🎉

**Generated**: 2025-10-22
